# 🌱 数字花园使用指南

> **AstroSupabase Digital Garden** - 一个现代化的数字知识管理平台

---

## 📖 目录

- [产品概述](#产品概述)
- [核心功能](#核心功能)
- [快速开始](#快速开始)
- [使用场景](#使用场景)
- [常见问题](#常见问题)

---

## 🎯 产品概述

### 什么是数字花园？

数字花园是一个**知识管理平台**，让您能够：

- 📝 创建和组织知识笔记
- 🔗 通过双向链接建立知识网络
- 📊 可视化知识图谱，探索内容关联
- 🏷️ 使用标签分类和检索内容
- 🔍 快速搜索和发现相关知识

### 核心优势

| 特性 | 说明 |
|------|------|
| ⚡ **极速加载** | 云端预渲染，页面加载速度提升 41 倍 |
| 🎨 **美观界面** | 现代化的 Quartz 风格设计，支持深色/浅色主题 |
| 📱 **响应式设计** | 完美适配桌面、平板和手机 |
| 🔒 **安全可靠** | 基于 Supabase，企业级数据安全 |
| 🚀 **易于部署** | 一键部署到 Vercel，自动云端预渲染 |

---

## ✨ 核心功能

### 1. 📝 文章管理

**是什么**：创建、编辑和管理您的知识文章

**怎么用**：

#### 创建新文章

1. 登录后访问 **仪表板** → **文章管理**
2. 点击 **"新建文章"**
3. 填写文章信息：
   - **标题**：文章标题
   - **Slug**：URL 友好标识（自动生成）
   - **摘要**：简短描述
   - **标签**：用逗号分隔（如：`技术, 教程, Astro`）
   - **状态**：选择 `已发布` 或 `草稿`
4. 在编辑器中编写 **Markdown** 内容
5. 点击 **"保存"**

#### 编辑文章

1. 在文章列表中找到目标文章
2. 点击 **"编辑"**
3. 修改内容后保存

#### 文章格式示例

```markdown
---
title: "我的第一篇笔记"
slug: "my-first-note"
excerpt: "这是摘要"
tags: [技术, 教程]
status: published
---

# 标题

这是正文内容。

## 使用双向链接

链接到其他文章：[[文章标题]]

使用别名：[[文章标题|显示文本]]

## 使用标签

#技术 #教程 #学习
```

---

### 2. 🔗 双向链接

**是什么**：通过 `[[文章标题]]` 语法创建文章之间的链接，形成知识网络

**怎么用**：

#### 创建链接

在文章内容中使用双括号语法：

```markdown
阅读 [[Astro 框架]] 了解更多。

或者使用别名：[[Astro 框架|点击这里]]
```

#### 查看链接关系

- **前向链接**：当前文章链接到的其他文章（文章底部显示）
- **反向链接**：链接到当前文章的其他文章（文章底部显示）
- **知识图谱**：可视化所有链接关系

#### 优势

- ✅ 自动发现相关内容
- ✅ 建立知识网络
- ✅ 便于探索和学习

---

### 3. 📊 知识图谱

**是什么**：可视化的知识网络，展示文章和标签之间的关联关系

**怎么用**：

#### 局部图谱

每篇文章页面右侧显示**局部知识图谱**：
- 显示当前文章相关的节点（默认深度 1）
- 节点代表文章或标签
- 连线表示链接关系

**交互操作**：
- 🖱️ **点击节点**：跳转到对应文章或标签页
- 🖱️ **拖拽节点**：调整布局
- 🔍 **滚轮缩放**：放大/缩小查看
- 🎯 **悬停节点**：高亮相关连接

#### 全局图谱

访问文章页面，点击右上角的 **🌐 图标**，或按 **Ctrl+G**：

- 显示所有文章和标签
- 完整的知识网络视图
- 更大的画布进行探索

**图谱节点说明**：
- 🔵 **蓝色节点**：当前文章
- 🟢 **绿色节点**：已访问的文章
- ⚪ **灰色节点**：未访问的文章
- 🏷️ **带边框的节点**：标签

---

### 4. 🏷️ 标签系统

**是什么**：通过标签对文章进行分类和组织

**怎么用**：

#### 添加标签

1. 创建/编辑文章时，在 **标签** 字段输入
2. 多个标签用**逗号分隔**：`技术, 教程, 前端`
3. 保存文章后标签自动关联

#### 浏览标签

1. 访问 **标签页**：`/tags`
2. 查看所有标签及其文章数量
3. 点击标签查看该标签下的所有文章

#### 在内容中使用标签

在 Markdown 内容中也可以使用 `#标签名` 格式：

```markdown
这是一篇关于 #技术 和 #学习 的文章。
```

---

### 5. 🔍 搜索功能

**是什么**：全文搜索，快速找到相关内容

**怎么用**：

1. 点击右上角 **🔍 搜索图标** 或按 **Ctrl+K**
2. 输入关键词
3. 实时显示匹配结果
4. 点击结果跳转到对应文章

**搜索特性**：
- ✅ 标题和内容全文搜索
- ✅ 实时高亮匹配关键词
- ✅ 支持中文搜索

---

### 6. 🎨 主题切换

**是什么**：深色/浅色主题模式切换

**怎么用**：

1. 点击右上角 **🌙/☀️ 图标**
2. 或按 **Ctrl+D** 快捷键
3. 主题立即切换，设置自动保存

---

### 7. 📖 阅读模式

**是什么**：专注阅读模式，隐藏侧边栏等干扰元素

**怎么用**：

1. 点击右上角 **📖 阅读模式图标**
2. 进入专注阅读界面
3. 再次点击退出

---

### 8. 📱 目录导航

**是什么**：文章内容大纲，快速跳转到章节

**怎么用**：

- 右侧显示文章目录（Table of Contents）
- 点击目录项跳转到对应章节
- 滚动时自动高亮当前位置

---

## 🚀 快速开始

### 环境要求

- Node.js 18+
- npm 或 yarn
- Supabase 账号（用于数据库）

### 安装步骤

#### 1️⃣ 克隆项目

```bash
git clone <repository-url>
cd AstroSupabase
```

#### 2️⃣ 安装依赖

```bash
npm install
# 或
yarn install
```

#### 3️⃣ 配置环境变量

创建 `.env` 文件：

```env
# Supabase 配置
PUBLIC_SUPABASE_URL=your_supabase_project_url
PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
DATABASE_URL=your_database_connection_string

# 站点配置
PUBLIC_SITE_URL=http://localhost:4321
```

**获取 Supabase 配置**：
1. 访问 [Supabase Dashboard](https://app.supabase.com)
2. 选择您的项目
3. Settings → API → 复制 URL 和 anon key
4. Settings → Database → Connection string → 复制连接字符串

#### 4️⃣ 初始化数据库

**方式一：使用 Supabase Dashboard**
1. 登录 Supabase Dashboard
2. 进入 SQL Editor
3. 执行 `drizzle/` 目录下的 SQL 迁移文件

**方式二：使用命令行**
```bash
npm run db:push
```

#### 5️⃣ 启动开发服务器

```bash
npm run dev
```

访问：**http://localhost:4321**

---

### 部署到生产环境

#### Vercel 部署（推荐）

**一键部署**：

1. 将代码推送到 GitHub
2. 在 [Vercel](https://vercel.com) 导入项目
3. 配置环境变量：
   - `DATABASE_URL`
   - `PUBLIC_SUPABASE_URL`
   - `PUBLIC_SUPABASE_ANON_KEY`
4. 点击 **Deploy**

**自动化部署**：

项目已配置云端自动预渲染，每次推送代码到 GitHub 后：

1. ✅ Vercel 自动检测变更
2. ✅ 自动预渲染所有文章（多线程）
3. ✅ 自动构建站点
4. ✅ 自动部署上线

**部署命令**：
```bash
git add .
git commit -m "Update content"
git push
```

就这么简单！ 🎉

---

## 💡 使用场景

### 场景一：建立个人知识库

**目标**：创建一个关于 Web 开发的知识库

**步骤**：

1. **创建核心文章**
   - "前端开发入门"
   - "JavaScript 基础"
   - "React 框架介绍"

2. **建立链接关系**
   ```
   前端开发入门 → [[JavaScript 基础]]
   前端开发入门 → [[React 框架介绍]]
   ```

3. **添加标签**
   - 所有文章添加 `#前端` 标签
   - JavaScript 相关添加 `#JavaScript`
   - React 相关添加 `#React`

4. **可视化探索**
   - 打开任何一篇文章
   - 查看右侧知识图谱
   - 点击相关节点探索更多内容

5. **持续更新**
   - 添加新文章时自动建立链接
   - 知识网络自动扩展

**效果**：
- 📚 知识有序组织
- 🔗 相关内容自动关联
- 📊 知识图谱清晰展示知识结构
- 🔍 快速搜索和发现

---

### 场景二：团队知识共享

**目标**：团队内部知识管理和共享

**步骤**：

1. **创建团队账号**
   - 使用 Supabase 认证系统
   - 分配编辑权限

2. **分类创建文章**
   ```
   /技术文档/
     - API 使用指南
     - 数据库设计规范
     - 代码审查流程
   
   /产品文档/
     - 产品规划
     - 用户需求分析
     - 竞品分析
   ```

3. **建立知识链接**
   - 在相关文档间创建双向链接
   - 使用标签进行跨文档分类

4. **团队协作**
   - 成员可编辑和更新文档
   - 评论和反馈系统
   - 版本历史追踪

5. **知识发现**
   - 使用搜索快速找到文档
   - 通过知识图谱发现关联内容
   - 通过标签浏览同类文档

**效果**：
- 👥 团队知识集中管理
- 🔗 文档关系清晰可见
- 🔍 快速检索和发现
- 📈 知识网络持续增长

---

## ❓ 常见问题

### 安装与配置

#### Q1: 安装依赖时出错怎么办？

**可能原因**：
- Node.js 版本过低（需要 18+）
- 网络问题导致下载失败
- 包管理器版本过旧

**解决方案**：
```bash
# 检查 Node.js 版本
node --version  # 应该 >= 18.0.0

# 更新 npm
npm install -g npm@latest

# 清理缓存后重试
npm cache clean --force
npm install
```

#### Q2: 无法连接到数据库？

**检查清单**：
- ✅ `.env` 文件中的 `DATABASE_URL` 是否正确
- ✅ Supabase 项目是否激活
- ✅ 数据库连接字符串格式是否正确
- ✅ 防火墙是否阻止连接

**解决方案**：
1. 验证 Supabase Dashboard 中项目状态
2. 重新复制连接字符串
3. 检查 `.env` 文件位置（应在项目根目录）
4. 重启开发服务器

---

### 内容管理

#### Q3: 双向链接不工作？

**可能原因**：
- 链接的文章不存在
- Slug 格式不正确
- 数据库链接关系未更新

**解决方案**：
1. 确认目标文章已创建且已发布
2. 检查链接语法：`[[文章标题]]`
3. 保存文章后等待链接关系更新（自动处理）
4. 刷新页面查看效果

#### Q4: 知识图谱显示空白？

**检查清单**：
- ✅ 是否有已发布的文章
- ✅ 文章之间是否有链接关系
- ✅ 浏览器控制台是否有错误
- ✅ `/api/content-index.json` 是否可访问

**解决方案**：
```bash
# 1. 检查 API 端点
curl http://localhost:4321/api/content-index.json

# 2. 检查数据库是否有数据
# 访问 Supabase Dashboard → Table Editor → articles

# 3. 清除浏览器缓存后刷新
```

#### Q5: 标签页面显示 404？

**可能原因**：
- 标签路由未正确配置
- 文章未正确关联标签

**解决方案**：
1. 确认文章已添加标签
2. 访问 `/tags` 查看所有标签
3. 点击标签名称跳转到标签详情页

---

### 部署问题

#### Q6: Vercel 部署失败？

**常见错误**：

**错误 1: DATABASE_URL not found**
```bash
解决方案：
1. 访问 Vercel Dashboard
2. Settings → Environment Variables
3. 添加 DATABASE_URL
4. 重新部署
```

**错误 2: Build timeout**
```bash
解决方案：
1. 检查文章数量（大量文章可能需要更长时间）
2. 查看 Vercel 构建日志
3. 考虑升级 Vercel 计划
```

**错误 3: Pre-rendering failed**
```bash
解决方案：
1. 检查数据库连接
2. 确认环境变量配置正确
3. 查看构建日志中的具体错误信息
```

#### Q7: 生产环境加载很慢？

**可能原因**：
- 未启用预渲染
- 数据库连接慢
- 大量未优化内容

**解决方案**：
1. 确认使用 `npm run build:full`（包含预渲染）
2. 检查 Vercel 构建日志，确认预渲染成功
3. 查看浏览器 Network 面板，定位慢速请求

---

### 功能使用

#### Q8: 搜索找不到内容？

**可能原因**：
- 搜索关键词不匹配
- 文章内容未索引
- 搜索功能未正确初始化

**解决方案**：
1. 尝试使用文章标题关键词
2. 检查文章是否已发布
3. 刷新页面后重试搜索

#### Q9: 无法切换主题？

**解决方案**：
1. 清除浏览器缓存
2. 检查浏览器是否支持 localStorage
3. 尝试使用快捷键 `Ctrl+D`

#### Q10: 知识图谱节点重叠？

**调整方案**：
- 图谱会自动计算布局，但节点过多时可能重叠
- 使用滚轮放大查看
- 拖拽节点调整位置
- 节点会自动重新排列

---

## 📞 获取帮助

### 文档资源

- 📖 **项目 README**: `README.md`
- 🚀 **部署指南**: `DEPLOYMENT_GUIDE.md`
- 🔧 **技术文档**: 项目根目录下的其他 `.md` 文件

### 技术支持

- 🐛 **报告问题**: GitHub Issues
- 💬 **社区讨论**: GitHub Discussions
- 📧 **联系维护者**: 通过项目仓库

---

## 🎉 开始使用

现在您已经了解了数字花园的所有核心功能！

**下一步**：
1. ✅ 完成安装和配置
2. ✅ 创建第一篇文章
3. ✅ 建立文章之间的链接
4. ✅ 探索知识图谱
5. ✅ 享受知识管理的乐趣！

---

**祝您使用愉快！** 🌱✨

---

*最后更新：2025年1月*
*版本：v1.0*

