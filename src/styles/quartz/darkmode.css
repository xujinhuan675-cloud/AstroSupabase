/**
 * Darkmode 样式
 * 从 Quartz 迁移
 * 
 * 性能优化：
 * - 使用 CSS 变量实现平滑过渡
 * - 避免页面闪烁和重排
 */

/* 主题过渡动画（仅在初始化后启用，避免首次加载闪烁） */
:root.theme-transition-enabled {
  transition: 
    background-color 0.3s ease,
    color 0.3s ease;
}

:root.theme-transition-enabled *,
:root.theme-transition-enabled *::before,
:root.theme-transition-enabled *::after {
  transition: 
    background-color 0.3s ease,
    border-color 0.3s ease,
    color 0.3s ease,
    fill 0.3s ease,
    stroke 0.3s ease;
}

/* 禁用某些元素的过渡（避免性能问题） */
:root.theme-transition-enabled img,
:root.theme-transition-enabled video,
:root.theme-transition-enabled canvas,
:root.theme-transition-enabled svg path,
:root.theme-transition-enabled .no-transition {
  transition: none !important;
}

.darkmode {
  cursor: pointer;
  padding: 0;
  position: relative;
  background: none;
  border: none;
  width: 20px;
  height: 20px;
  margin: 0;
  text-align: inherit;
  flex-shrink: 0;
  display: block !important;
  min-width: 20px;
  min-height: 20px;
}

.darkmode svg {
  position: absolute;
  width: 20px;
  height: 20px;
  top: 0;
  left: 0;
  fill: var(--darkgray);
  transition: opacity 0.2s ease, transform 0.2s ease;
  display: block;
}

/* 悬停效果 */
.darkmode:hover svg {
  transform: scale(1.1);
}

/* 主题控制 */
:root[saved-theme="dark"] {
  color-scheme: dark;
}

:root[saved-theme="light"] {
  color-scheme: light;
}

/* 暗色模式下的图标显示 */
:root[saved-theme="dark"] .darkmode > .dayIcon {
  opacity: 0;
  transform: rotate(-90deg) scale(0.8);
}

:root[saved-theme="dark"] .darkmode > .nightIcon {
  opacity: 1;
  transform: rotate(0) scale(1);
}

/* 亮色模式下的图标显示 */
:root[saved-theme="light"] .darkmode > .dayIcon,
:root:not([saved-theme]) .darkmode > .dayIcon {
  opacity: 1;
  transform: rotate(0) scale(1);
}

:root[saved-theme="light"] .darkmode > .nightIcon,
:root:not([saved-theme]) .darkmode > .nightIcon {
  opacity: 0;
  transform: rotate(90deg) scale(0.8);
}

/* 暗色模式颜色变量 */
:root[saved-theme="dark"] {
  --light: #161618;
  --lightgray: #393639;
  --gray: #646464;
  --darkgray: #d4d4d4;
  --dark: #ebebec;
  --secondary: #7b97aa;
  --tertiary: #84a59d;
  --highlight: rgba(143, 159, 169, 0.15);
  --textHighlight: #b3aa0288;
}

/* 亮色模式颜色变量（默认在 variables.css 中已定义） */
:root[saved-theme="light"] {
  --light: #faf8f8;
  --lightgray: #e5e5e5;
  --gray: #b8b8b8;
  --darkgray: #4e4e4e;
  --dark: #2b2b2b;
  --secondary: #284b63;
  --tertiary: #84a59d;
  --highlight: rgba(143, 159, 169, 0.15);
  --textHighlight: #fff23688;
}

