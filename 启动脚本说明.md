# 🚀 快捷启动脚本使用指南

本项目提供了多个 PowerShell 脚本来简化开发流程，解决 Windows 环境下的 PWD 环境变量问题。

---

## 📂 脚本文件清单

| 脚本文件 | 用途 | 使用场景 |
|---------|------|---------|
| `dev-install.ps1` | 安装依赖 | 首次使用或需要重新安装 |
| `dev-local.ps1` | 启动开发服务器 | 日常开发（最常用）⭐ |
| `dev-build.ps1` | 构建生产版本 | 准备部署前 |
| `dev-clean.ps1` | 清理并重装 | 遇到依赖问题时 |

---

## 🎯 快速开始（首次使用）

### 步骤 1：安装依赖
双击运行 **`dev-install.ps1`**

或在 PowerShell 中：
```powershell
cd F:\IOTO-Doc\astro-supabase-blog
.\dev-install.ps1
```

### 步骤 2：配置环境变量
创建 `.env` 文件：
```env
PUBLIC_SUPABASE_URL=你的_supabase_url
PUBLIC_SUPABASE_ANON_KEY=你的_supabase_key
DATABASE_URL=你的_数据库连接
PUBLIC_SITE_URL=http://localhost:4321
```

### 步骤 3：启动开发服务器
双击运行 **`dev-local.ps1`** ⭐

---

## 📖 详细使用说明

### 1. dev-install.ps1 - 安装依赖

**功能**：
- ✅ 设置 PWD 环境变量
- ✅ 检查 npm 是否安装
- ✅ 安装所有项目依赖
- ✅ 显示友好的中英文提示

**使用时机**：
- 首次克隆项目
- 更新了 package.json
- 添加了新的依赖包

**运行方式**：
```powershell
# 方式 1：双击运行（推荐）
# 直接双击 dev-install.ps1 文件

# 方式 2：命令行运行
.\dev-install.ps1
```

---

### 2. dev-local.ps1 - 启动开发服务器 ⭐

**功能**：
- ✅ 自动设置 PWD 环境变量（解决 varlock 错误）
- ✅ 设置 NODE_ENV=development
- ✅ 启动 Astro 开发服务器
- ✅ 显示访问地址：http://localhost:4321

**使用时机**：
- 每次开发时（最常用）
- 调试和测试功能

**运行方式**：
```powershell
# 方式 1：双击运行（推荐）⭐
# 直接双击 dev-local.ps1 文件

# 方式 2：命令行运行
.\dev-local.ps1
```

**特点**：
- 🎨 彩色输出，易于阅读
- 🌐 自动显示访问地址
- 📝 中英文双语提示

---

### 3. dev-build.ps1 - 构建生产版本

**功能**：
- ✅ 设置 PWD 环境变量
- ✅ 设置 NODE_ENV=production
- ✅ 构建优化的生产版本
- ✅ 输出到 ./dist 目录

**使用时机**：
- 准备部署到服务器
- 测试生产构建
- 检查构建是否成功

**运行方式**：
```powershell
.\dev-build.ps1
```

**构建后预览**：
```powershell
npm run preview
```

---

### 4. dev-clean.ps1 - 清理并重装

**功能**：
- ⚠️ 删除 node_modules
- ⚠️ 删除 package-lock.json
- ✅ 重新安装所有依赖
- ✅ 二次确认防止误操作

**使用时机**：
- 依赖出现冲突
- 安装失败需要重试
- 升级主要版本后

**运行方式**：
```powershell
.\dev-clean.ps1
# 会要求确认：Continue? 继续吗？ (y/N)
```

---

## 🔧 常见问题解决

### Q1: 双击脚本闪退？

**解决方案**：
1. 右键点击脚本
2. 选择"使用 PowerShell 运行"
3. 或在 PowerShell 中手动运行

### Q2: 提示"无法加载，禁止运行脚本"？

**解决方案**：
```powershell
# 以管理员身份运行 PowerShell
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser

# 然后重新运行脚本
```

### Q3: 仍然提示 "PWD is not set"？

**解决方案**：
1. 确保使用脚本启动（不要直接用 `npm run dev`）
2. 检查脚本是否正确设置了 `$env:PWD`
3. 尝试运行 `dev-clean.ps1` 清理后重试

### Q4: npm 命令找不到？

**解决方案**：
1. 安装 Node.js：https://nodejs.org/
2. 重启 PowerShell
3. 运行 `node --version` 确认安装成功

---

## 💡 使用技巧

### 技巧 1：创建桌面快捷方式

1. 右键点击 `dev-local.ps1`
2. 选择"发送到" → "桌面快捷方式"
3. 重命名为"启动混合博客"
4. 双击快捷方式即可启动

### 技巧 2：使用 Windows Terminal

在 Windows Terminal 中运行体验更好：
```powershell
wt -d F:\IOTO-Doc\astro-supabase-blog .\dev-local.ps1
```

### 技巧 3：VS Code 集成

在 VS Code 的 `.vscode/tasks.json` 中添加：
```json
{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Start Dev Server",
      "type": "shell",
      "command": ".\\dev-local.ps1",
      "problemMatcher": [],
      "group": {
        "kind": "build",
        "isDefault": true
      }
    }
  ]
}
```

然后按 `Ctrl+Shift+B` 快速启动。

---

## 📊 脚本对比

| 操作 | 传统方式 | 使用脚本 |
|------|---------|---------|
| 设置环境变量 | 手动在系统设置 | ✅ 自动设置 |
| 启动开发 | `npm run dev` 可能报错 | ✅ 一键启动 |
| 错误提示 | 英文错误信息 | ✅ 中英文友好提示 |
| 视觉效果 | 黑白文本 | ✅ 彩色输出 |

---

## 🎯 日常开发流程

### 标准流程：

```
1. 双击 dev-local.ps1  ⭐
   ↓
2. 等待启动完成
   ↓
3. 浏览器访问 http://localhost:4321
   ↓
4. 编辑代码，实时预览
   ↓
5. 按 Ctrl+C 停止服务器
```

### 完整流程（首次）：

```
1. 双击 dev-install.ps1（首次）
   ↓
2. 创建 .env 文件
   ↓
3. 双击 dev-local.ps1
   ↓
4. 开始开发
```

---

## 📝 脚本内容说明

所有脚本都包含：
- ✅ PWD 环境变量设置（解决核心问题）
- ✅ 自动切换到项目目录
- ✅ 彩色输出和清晰格式
- ✅ 中英文双语提示
- ✅ 错误处理和友好提示

---

## 🆘 需要帮助？

如果遇到问题：
1. 查看本文档的"常见问题解决"部分
2. 检查 Node.js 和 npm 是否正确安装
3. 确保在项目根目录运行脚本
4. 查看终端的错误信息

---

## ✨ 下一步

现在您可以：
1. ✅ 使用 `dev-install.ps1` 安装依赖
2. ✅ 使用 `dev-local.ps1` 启动开发（最常用）
3. ✅ 开始编写代码！

**推荐**：将 `dev-local.ps1` 的快捷方式放到桌面，方便快速启动！

---

**祝开发愉快！** 🚀

