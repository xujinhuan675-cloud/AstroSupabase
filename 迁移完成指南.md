# 🎉 迁移完成！混合博客系统使用指南

## ✅ 迁移概况

**迁移方案**：混合模式（方案 A）  
**迁移时间**：已完成  
**状态**：✅ 所有功能正常

### 已实现功能

#### 📝 Obsidian Vault 功能（来自 AstrOb）
- ✅ Wiki 链接 `[[笔记名]]`
- ✅ 标签系统
- ✅ 反向链接
- ✅ 明暗主题切换
- ✅ 静态生成

#### 📰 数据库文章功能（原有）
- ✅ Web 后台管理
- ✅ 用户认证（Supabase）
- ✅ 在线编辑器
- ✅ 文章 CRUD

---

## 🚀 立即开始

### 1. 安装依赖

```bash
cd F:\IOTO-Doc\astro-supabase-blog
yarn install
```

### 2. 配置环境变量

创建 `.env` 文件：

```env
PUBLIC_SUPABASE_URL=你的_supabase_url
PUBLIC_SUPABASE_ANON_KEY=你的_supabase_key
DATABASE_URL=你的_数据库连接
PUBLIC_SITE_URL=http://localhost:4321
```

### 3. 启动开发服务器

```bash
yarn dev
```

访问：`http://localhost:4321`

---

## 📚 内容管理

### 方式一：Obsidian 笔记（静态）

**适用场景**：知识笔记、文档、个人知识库

**添加笔记**：
1. 在 `src/content/vault/` 创建 `.md` 文件
2. 添加 frontmatter：
   ```yaml
   ---
   title: 我的笔记
   description: 这是一篇测试笔记
   tags: ["测试", "笔记"]
   publish: true
   author: default
   ---
   ```
3. 编写内容，使用 `[[链接]]` 连接其他笔记
4. 提交 Git，自动部署

**访问路径**：`/vault/笔记名`

### 方式二：数据库文章（动态）

**适用场景**：博客文章、公告、动态内容

**添加文章**：
1. 访问 `/auth/login` 登录
2. 进入 `/dashboard` 后台
3. 点击"新建文章"
4. 在线编辑，发布或保存草稿

**访问路径**：`/articles/[id]`

---

## 🎯 主要页面

| 路径 | 说明 | 内容类型 |
|------|------|---------|
| `/` | 首页 | 同时显示两种内容 |
| `/vault` | 笔记列表 | Obsidian 笔记 |
| `/vault/[slug]` | 笔记详情 | Obsidian 笔记 |
| `/articles` | 文章列表 | 数据库文章 |
| `/articles/[id]` | 文章详情 | 数据库文章 |
| `/tags/[tag]` | 标签筛选 | Obsidian 笔记（按标签） |
| `/dashboard` | 管理后台 | 文章管理 |
| `/auth/login` | 登录 | 认证 |

---

## 🎨 主题和样式

### 切换主题
- 点击右上角的 🌙/☀️ 图标
- 自动保存用户偏好
- 支持明暗两种模式

### 自定义主题
编辑 `src/styles/theme.default.css`：

```css
:root {
  --theme-primary: #06b6d4;      /* 主色调 */
  --theme-bg-main: #ffffff;      /* 背景色 */
  --theme-text-primary: #111827; /* 文字色 */
}
```

---

## 📁 目录结构

```
astro-supabase-blog/
├── src/
│   ├── collections/          # Content 集合配置
│   │   ├── authors.ts
│   │   ├── documents.ts     # Obsidian 文档
│   │   └── tags.ts
│   ├── components/
│   │   ├── ThemeToggle.astro # 主题切换
│   │   ├── ArticleCard.astro
│   │   └── ...
│   ├── content/
│   │   ├── vault/           # 🔥 在这里添加 Obsidian 笔记！
│   │   ├── authors/
│   │   └── tags/
│   ├── pages/
│   │   ├── vault/           # Obsidian 笔记页面
│   │   ├── articles/        # 数据库文章页面
│   │   ├── dashboard/       # 后台管理
│   │   └── index.astro      # 首页
│   ├── styles/
│   │   ├── global.css       # 全局样式
│   │   └── theme.default.css
│   └── db/
│       └── schema.ts        # 数据库表定义
├── website.config.json      # 网站配置
├── astro.config.ts          # Astro 配置
├── package.json
└── README.md
```

---

## 🔧 常用命令

```bash
# 开发
yarn dev              # 启动开发服务器
yarn build            # 构建生产版本
yarn preview          # 预览生产构建

# 内容管理
yarn astro sync       # 同步 content collections
```

---

## 💡 使用技巧

### 1. 内容分类建议

| 内容类型 | 推荐方式 | 原因 |
|---------|---------|------|
| 技术笔记 | Obsidian | 便于本地管理和链接 |
| 学习笔记 | Obsidian | 支持 Wiki 链接，建立知识网络 |
| 博客文章 | 数据库 | 随时随地在线发布 |
| 项目文档 | Obsidian | 静态生成，加载快速 |
| 公告通知 | 数据库 | 实时更新 |

### 2. Wiki 链接使用

```markdown
# 在 Obsidian 笔记中

查看 [[getting-started]] 了解更多。

相关内容：
- [[功能介绍]]
- [[安装指南]]

#教程 #快速开始
```

### 3. 标签组织

在笔记的 frontmatter 中定义标签：
```yaml
---
tags: ["技术", "Astro", "教程"]
---
```

访问 `/tags/技术` 查看所有相关笔记。

---

## 🚢 部署到 Vercel

### 步骤

1. **推送到 GitHub**
   ```bash
   git add .
   git commit -m "feat: 完成混合博客迁移"
   git push origin main
   ```

2. **在 Vercel 导入项目**
   - 访问 [vercel.com](https://vercel.com)
   - 导入 GitHub 仓库

3. **配置环境变量**
   在 Vercel 项目设置中添加：
   - `PUBLIC_SUPABASE_URL`
   - `PUBLIC_SUPABASE_ANON_KEY`
   - `DATABASE_URL`
   - `PUBLIC_SITE_URL`

4. **部署**
   - Vercel 自动构建和部署
   - 每次 Git 推送都会触发自动部署

---

## 📊 功能对比

### 迁移前 vs 迁移后

| 功能 | 迁移前 | 迁移后 |
|------|--------|--------|
| 内容管理方式 | 仅数据库 | Obsidian + 数据库 |
| 静态页面 | ❌ | ✅ |
| Wiki 链接 | ❌ | ✅ |
| 在线编辑 | ✅ | ✅ |
| 主题切换 | ❌ | ✅ |
| 标签系统 | 部分 | ✅ 完整 |
| 反向链接 | ❌ | ✅ |

---

## ❓ 常见问题

### Q: 如何在本地 Obsidian 中管理笔记？

A: 将 Obsidian vault 指向 `F:/IOTO-Doc/astro-supabase-blog/src/content/vault/` 目录即可。

### Q: 笔记不显示怎么办？

A: 检查 frontmatter 中 `publish: true` 是否设置。

### Q: Wiki 链接不工作？

A: 确保链接的目标笔记存在，且文件名匹配。

### Q: 如何修改首页布局？

A: 编辑 `src/pages/index.astro` 文件。

### Q: 能否只使用一种内容管理方式？

A: 可以！两种方式互不干扰，可以只用其中一种。

---

## 📖 延伸阅读

- **[完整迁移指南](./MIGRATION-GUIDE.md)** - 详细的迁移文档
- **[项目 README](./README.md)** - 项目介绍和使用说明
- **[AstrOb 原项目](../AstrOb/)** - 查看原始项目

---

## 🎊 下一步

1. ✅ **添加第一篇 Obsidian 笔记**
   - 在 `src/content/vault/` 创建 `my-first-note.md`

2. ✅ **创建第一篇数据库文章**
   - 访问 `/dashboard` 创建文章

3. ✅ **自定义样式**
   - 修改 `src/styles/theme.default.css`

4. ✅ **部署到线上**
   - 推送到 GitHub，连接 Vercel

---

## 🎯 成功！

您的混合博客系统已经准备就绪！

- ✨ 两种内容管理方式
- 🚀 快速、现代、灵活
- 💪 强大的功能支持

**开始创作吧！** 📝

---

*有问题？查看详细文档或提交 Issue。*

